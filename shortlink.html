<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì§§ì€ ì£¼ì†Œ ìƒì„±ê¸° | GrewTools</title>
  <meta name="description" content="ê¸´ URLì„ ì§§ê²Œ! ê³µìœ ì™€ í´ë¦­ë¥ ì„ ë†’ì´ëŠ” ë‹¨ì¶•ì£¼ì†Œ ìƒì„±ê¸°" />
  <link rel="icon" href="/assets/favicon.ico" />
  <link rel="stylesheet" href="/assets/responsive.css">

  <style>
    .page-shortlink {
      font-family:'Noto Sans KR',Pretendard,sans-serif;
      background:#faf7f2;
      color:#333;
      margin:0;
    }

    .page-shortlink header {
      position:relative !important;
      z-index:1 !important;
      overflow:visible !important;
      padding:30px 20px;
      text-align:center;
      color:#fff;
      background:linear-gradient(135deg,#6fbf73,#ffd9b3);
      border-bottom-left-radius:30px;
      border-bottom-right-radius:30px;
      box-shadow:0 4px 10px rgba(0,0,0,.1);
    }

    .page-shortlink .wrap {
      max-width:900px;
      margin:40px auto;
      background:#fff;
      border-radius:20px;
      padding:24px 24px 30px;
      box-shadow:0 4px 10px rgba(0,0,0,.08);
    }

    .page-shortlink .row {
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }

    .page-shortlink input[type=url],
    .page-shortlink input[type=text] {
      flex:1;
      min-width:260px;
      border:1px solid #d9d4cd;
      border-radius:12px;
      padding:12px 14px;
      font-size:15px;
    }

    .page-shortlink button {
      background:#6fbf73;
      color:#fff;
      border:none;
      border-radius:20px;
      padding:12px 18px;
      cursor:pointer;
      transition:.2s;
    }
    .page-shortlink button:hover { background:#5aa261; }

    .page-shortlink .card {
      background:#fffdf9;
      border:1px dashed #f0cda5;
      border-radius:16px;
      padding:14px 16px;
      margin-top:16px;
    }

    .page-shortlink footer {
      text-align:center;
      padding:30px 20px;
      font-size:.9em;
      color:#777;
      border-top:1px solid #e0ddd8;
      margin-top:40px;
    }
  </style>
</head>

<body class="page-shortlink">
  <div id="gt-nav"></div>
  <script src="/assets/nav-loader.js" defer></script>
  <script src="/assets/nav.js" defer></script>

  <header>
    <h1>ğŸ”— ì§§ì€ ì£¼ì†Œ ìƒì„±ê¸°</h1>
    <p>ê³µìœ ë¥¼ ì‰½ê²Œ! í•œ ë²ˆì— ë‹¨ì¶• & ë³µì‚¬ ğŸš€</p>
  </header>

  <div class="wrap" id="app">
    <h2>1ï¸âƒ£ ê¸´ URL ë¶™ì—¬ë„£ê¸°</h2>

    <div class="row">
      <input id="longUrl" type="url" placeholder="https://example.com..." />
      <button onclick="shorten()">ë‹¨ì¶•í•˜ê¸°</button>
    </div>

    <div class="card" id="out" style="display:none">
      <div class="row">
        <input id="shortUrl" type="text" readonly />
        <button onclick="copyShort()">ë³µì‚¬</button>
      </div>
    </div>

    <h2>2ï¸âƒ£ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë¯¸ë¦¬ë³´ê¸°</h2>
    <button onclick="openRedirectPreview()">ì—´ê¸°</button>
    <div style="margin-top:10px;color:#777">
      ìµœê·¼ ì½”ë“œ: <span id="lastCode">-</span>
    </div>
  </div>

  <footer>
    <p>Â© 2025 GrewTools. All rights reserved.</p>
  </footer>

  <script>
    function genCode(len=5){
      const s='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      return Array(len).fill(0).map(_=>s[Math.floor(Math.random()*s.length)]).join('');
    }
    function normalizeUrl(u){
      try{
        if(!/^https?:\/\//i.test(u)) u='https://'+u;
        return new URL(u).toString();
      }catch(e){ return null; }
    }

    function shorten(){
      const raw=document.getElementById('longUrl').value.trim();
      const norm=normalizeUrl(raw);
      if(!norm){ alert('URLì„ í™•ì¸í•´ì£¼ì„¸ìš”'); return; }

      const code=genCode();
      const map=JSON.parse(localStorage.getItem('gt_shortmap')||'{}');
      map[code]={url:norm, t:Date.now()};
      localStorage.setItem('gt_shortmap',JSON.stringify(map));

      const short=`${location.origin}${location.pathname}?c=${code}&mode=go`;
      document.getElementById('shortUrl').value=short;
      document.getElementById('lastCode').textContent=code;
      document.getElementById('out').style.display='block';
    }

    function copyShort(){
      navigator.clipboard.writeText(document.getElementById('shortUrl').value);
      alert('ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
    }

    function openRedirectPreview(){
      const code=document.getElementById('lastCode').textContent;
      if(code==='-'){ alert('ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”'); return; }
      window.open(`${location.pathname}?c=${code}&mode=go`,'_blank');
    }

    (function handleRedirect(){
      const p=new URLSearchParams(location.search);
      if(p.get('mode')==='go' && p.get('c')){
        const code=p.get('c');
        const map=JSON.parse(localStorage.getItem('gt_shortmap')||'{}');
        const hit=map[code];

        document.body.innerHTML=`
        <div style="max-width:720px;margin:12vh auto;background:#fff;border-radius:18px;padding:28px;box-shadow:0 4px 16px rgba(0,0,0,.08);text-align:center">
          <h2 style="color:#6fbf73">ì ì‹œë§Œìš”â€¦</h2>
          <p>ì•ˆì „í•˜ê²Œ ì´ë™ ì¤‘ì…ë‹ˆë‹¤.</p>
        </div>`;

        const target=hit?.url;
        const go=()=>{ if(target) location.replace(target); else alert('ë§¤í•‘ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤'); };
        setTimeout(go,1500);
      }
    })();
  </script>
</body>
</html>
