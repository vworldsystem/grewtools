<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì´ë¯¸ì§€ ì¼ê´„ ì••ì¶• â€” GrewTools</title>
  <meta name="description" content="ë“œë˜ê·¸ì•¤ë“œë¡­ìœ¼ë¡œ ê°„í¸í•œ ì´ë¯¸ì§€ ì••ì¶•. 10ê°œ ì´ë¯¸ì§€ ë™ì‹œ ì²˜ë¦¬, ë¬´ë£Œ ë‹¤ìš´ë¡œë“œ." />
  <link rel="icon" href="/assets/favicon.ico" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', Roboto, sans-serif;
      background: #0f0f1a;
      color: #fff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* í—¤ë” */
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
      background: rgba(0,0,0,0.4);
      border-bottom: 1px solid rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
      color: #fff;
    }
    .logo-icon {
      width: 44px;
      height: 44px;
      background: linear-gradient(135deg, #22c55e, #10b981);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      box-shadow: 0 4px 20px rgba(34, 197, 94, 0.3);
    }
    .logo-text h1 { font-size: 18px; font-weight: 700; }
    .logo-text p { font-size: 12px; color: rgba(255,255,255,0.5); margin-top: 2px; }

    .header-actions {
      display: flex;
      gap: 12px;
    }
    .action-btn {
      padding: 10px 20px;
      background: rgba(255,255,255,0.1);
      border: none;
      border-radius: 10px;
      color: #fff;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .action-btn:hover { background: rgba(255,255,255,0.2); }
    .action-btn.primary {
      background: linear-gradient(135deg, #22c55e, #10b981);
    }
    .action-btn.primary:hover { opacity: 0.9; }

    /* ë©”ì¸ */
    .main {
      flex: 1;
      max-width: 1400px;
      width: 100%;
      margin: 0 auto;
      padding: 40px 24px;
    }

    .page-header {
      text-align: center;
      margin-bottom: 40px;
    }
    .page-title {
      font-size: 36px;
      font-weight: 800;
      margin-bottom: 12px;
      background: linear-gradient(135deg, #22c55e, #10b981);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .page-subtitle {
      font-size: 16px;
      color: rgba(255,255,255,0.6);
    }

    /* ì„¤ì • íŒ¨ë„ */
    .settings-panel {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 24px;
      backdrop-filter: blur(10px);
    }
    .settings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 24px;
    }
    .setting-item {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .setting-label {
      font-size: 14px;
      font-weight: 600;
      color: rgba(255,255,255,0.8);
    }
    .setting-value {
      font-size: 20px;
      font-weight: 700;
      color: #22c55e;
    }
    .slider {
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: rgba(255,255,255,0.1);
      outline: none;
      -webkit-appearance: none;
    }
    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: linear-gradient(135deg, #22c55e, #10b981);
      cursor: pointer;
      box-shadow: 0 2px 10px rgba(34, 197, 94, 0.5);
    }
    .slider::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: linear-gradient(135deg, #22c55e, #10b981);
      cursor: pointer;
      border: none;
    }

    /* ì—…ë¡œë“œ ì˜ì—­ */
    .upload-area {
      background: rgba(255,255,255,0.04);
      border: 2px dashed rgba(255,255,255,0.2);
      border-radius: 20px;
      padding: 60px 40px;
      text-align: center;
      transition: all 0.3s;
      margin-bottom: 24px;
    }
    .upload-area.dragover {
      border-color: #22c55e;
      background: rgba(34, 197, 94, 0.1);
      transform: scale(1.02);
    }
    .upload-icon {
      font-size: 48px;
      margin-bottom: 16px;
    }
    .upload-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    .upload-subtitle {
      font-size: 14px;
      color: rgba(255,255,255,0.5);
      margin-bottom: 20px;
    }
    .upload-btn {
      padding: 14px 32px;
      background: linear-gradient(135deg, #22c55e, #10b981);
      border: none;
      border-radius: 12px;
      color: #fff;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
    }
    .upload-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(34, 197, 94, 0.4);
    }

    /* ì´ë¯¸ì§€ ê·¸ë¦¬ë“œ */
    .images-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 24px;
    }
    .image-card {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 16px;
      padding: 16px;
      backdrop-filter: blur(10px);
      transition: all 0.3s;
    }
    .image-card:hover {
      transform: translateY(-4px);
      border-color: rgba(34, 197, 94, 0.3);
    }
    .image-preview {
      width: 100%;
      aspect-ratio: 16/9;
      object-fit: cover;
      border-radius: 12px;
      margin-bottom: 12px;
      background: rgba(0,0,0,0.3);
    }
    .image-info {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .image-name {
      font-size: 13px;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .image-stats {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: rgba(255,255,255,0.6);
    }
    .size-badge {
      padding: 4px 10px;
      background: rgba(34, 197, 94, 0.2);
      border: 1px solid rgba(34, 197, 94, 0.3);
      border-radius: 12px;
      font-size: 11px;
      font-weight: 700;
      color: #86efac;
    }
    .remove-btn {
      width: 100%;
      padding: 8px;
      background: rgba(239, 68, 68, 0.2);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 8px;
      color: #fca5a5;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      margin-top: 8px;
    }
    .remove-btn:hover {
      background: rgba(239, 68, 68, 0.3);
    }

    /* ì•¡ì…˜ ë°” */
    .action-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 16px;
      backdrop-filter: blur(10px);
    }
    .action-stats {
      font-size: 14px;
      color: rgba(255,255,255,0.7);
    }
    .action-stats strong {
      font-weight: 700;
      color: #22c55e;
    }
    .action-buttons {
      display: flex;
      gap: 12px;
    }
    .compress-btn {
      padding: 14px 32px;
      background: linear-gradient(135deg, #22c55e, #10b981);
      border: none;
      border-radius: 12px;
      color: #fff;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .compress-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(34, 197, 94, 0.4);
    }
    .compress-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    .clear-btn {
      padding: 14px 24px;
      background: rgba(239, 68, 68, 0.2);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 12px;
      color: #fca5a5;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .clear-btn:hover {
      background: rgba(239, 68, 68, 0.3);
    }

    /* ìˆ¨ê¹€ */
    .hidden { display: none !important; }

    /* ë¡œë”© */
    .loading {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      backdrop-filter: blur(5px);
    }
    .loading.show {
      display: flex;
    }
    .spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(255,255,255,0.1);
      border-top-color: #22c55e;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* ë°˜ì‘í˜• */
    @media (max-width: 768px) {
      .main { padding: 24px 16px; }
      .page-title { font-size: 28px; }
      .settings-grid { grid-template-columns: 1fr; }
      .images-grid { grid-template-columns: 1fr; }
      .action-bar {
        flex-direction: column;
        gap: 16px;
      }
      .action-buttons {
        width: 100%;
        flex-direction: column;
      }
      .compress-btn, .clear-btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <!-- í—¤ë” -->
  <header class="header">
    <a href="/" class="logo">
      <div class="logo-icon">ğŸ“¦</div>
      <div class="logo-text">
        <h1>ì´ë¯¸ì§€ ì••ì¶•</h1>
        <p>ì¼ê´„ ì••ì¶• ë„êµ¬</p>
      </div>
    </a>
    <div class="header-actions">
      <a href="/" class="action-btn primary">ğŸ  í™ˆ</a>
    </div>
  </header>

  <!-- ë©”ì¸ -->
  <main class="main">
    <div class="page-header">
      <h2 class="page-title">ì´ë¯¸ì§€ ì¼ê´„ ì••ì¶•</h2>
      <p class="page-subtitle">ë“œë˜ê·¸ì•¤ë“œë¡­ìœ¼ë¡œ 10ê°œ ì´ë¯¸ì§€ ë™ì‹œ ì••ì¶•</p>
    </div>

    <!-- ì„¤ì • -->
    <div class="settings-panel">
      <div class="settings-grid">
        <div class="setting-item">
          <label class="setting-label">ì••ì¶• í’ˆì§ˆ</label>
          <input type="range" class="slider" id="qualitySlider" min="10" max="100" value="80">
          <div class="setting-value" id="qualityValue">80%</div>
        </div>
        <div class="setting-item">
          <label class="setting-label">ìµœëŒ€ ë„ˆë¹„ (í”½ì…€)</label>
          <input type="range" class="slider" id="widthSlider" min="400" max="2000" step="100" value="1200">
          <div class="setting-value" id="widthValue">1200px</div>
        </div>
        <div class="setting-item">
          <label class="setting-label">í¬ë§·</label>
          <select class="slider" id="formatSelect" style="height: 40px; padding: 0 12px; cursor: pointer;">
            <option value="jpeg">JPEG (ì‘ì€ ìš©ëŸ‰)</option>
            <option value="png">PNG (íˆ¬ëª… ë°°ê²½)</option>
            <option value="webp">WebP (ìµœì‹  í¬ë§·)</option>
          </select>
          <div class="setting-value" id="formatValue">JPEG</div>
        </div>
      </div>
    </div>

    <!-- ì—…ë¡œë“œ ì˜ì—­ -->
    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <h3 class="upload-title">ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì„¸ìš”</h3>
      <p class="upload-subtitle">JPG, PNG, GIF, WebP ì§€ì› â€¢ ìµœëŒ€ 10ê°œ</p>
      <button class="upload-btn" id="uploadBtn">íŒŒì¼ ì„ íƒ</button>
      <input type="file" id="fileInput" accept="image/*" multiple class="hidden">
    </div>

    <!-- ì´ë¯¸ì§€ ê·¸ë¦¬ë“œ -->
    <div class="images-grid" id="imagesGrid"></div>

    <!-- ì•¡ì…˜ ë°” -->
    <div class="action-bar hidden" id="actionBar">
      <div class="action-stats">
        <span>ì„ íƒëœ ì´ë¯¸ì§€: <strong id="imageCount">0</strong>ê°œ</span>
        <span style="margin-left: 20px;">ì˜ˆìƒ ì ˆê°: <strong id="savedSize">0 KB</strong></span>
      </div>
      <div class="action-buttons">
        <button class="compress-btn" id="compressBtn">âš¡ ì••ì¶• ì‹œì‘</button>
        <button class="clear-btn" id="clearBtn">ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ</button>
      </div>
    </div>
  </main>

  <!-- ë¡œë”© -->
  <div class="loading" id="loading">
    <div class="spinner"></div>
  </div>

  <script>
    // ì „ì—­ ë³€ìˆ˜
    let images = [];
    let settings = {
      quality: 0.8,
      maxWidth: 1200,
      format: 'jpeg'
    };

    // DOM ìš”ì†Œ
    const $ = (id) => document.getElementById(id);
    const uploadArea = $('uploadArea');
    const uploadBtn = $('uploadBtn');
    const fileInput = $('fileInput');
    const imagesGrid = $('imagesGrid');
    const actionBar = $('actionBar');
    const loading = $('loading');

    // ì´ˆê¸°í™”
    function init() {
      // íŒŒì¼ ì„ íƒ ë²„íŠ¼
      uploadBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        fileInput.click();
      });

      // ì—…ë¡œë“œ ì˜ì—­ í´ë¦­ (ë²„íŠ¼ ì œì™¸)
      uploadArea.addEventListener('click', (e) => {
        if (e.target.id !== 'uploadBtn' && !e.target.closest('#uploadBtn')) {
          fileInput.click();
        }
      });

      // ë“œë˜ê·¸ì•¤ë“œë¡­
      uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.classList.add('dragover');
      });

      uploadArea.addEventListener('dragleave', () => {
        uploadArea.classList.remove('dragover');
      });

      uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
        handleFiles(e.dataTransfer.files);
      });

      // íŒŒì¼ ì„ íƒ
      fileInput.addEventListener('change', (e) => {
        handleFiles(e.target.files);
        e.target.value = '';
      });

      // ì„¤ì • ë³€ê²½
      $('qualitySlider').addEventListener('input', (e) => {
        settings.quality = e.target.value / 100;
        $('qualityValue').textContent = e.target.value + '%';
        updateStats();
      });

      $('widthSlider').addEventListener('input', (e) => {
        settings.maxWidth = parseInt(e.target.value);
        $('widthValue').textContent = e.target.value + 'px';
        updateStats();
      });

      $('formatSelect').addEventListener('change', (e) => {
        settings.format = e.target.value;
        $('formatValue').textContent = e.target.value.toUpperCase();
        updateStats();
      });

      // ë²„íŠ¼
      $('compressBtn').addEventListener('click', compressAll);
      $('clearBtn').addEventListener('click', clearAll);
    }

    function handleFiles(files) {
      if (files.length + images.length > 10) {
        alert('ìµœëŒ€ 10ê°œê¹Œì§€ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        return;
      }

      Array.from(files).forEach(file => {
        if (!file.type.startsWith('image/')) {
          alert(file.name + 'ì€(ëŠ”) ì´ë¯¸ì§€ íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤.');
          return;
        }

        const reader = new FileReader();
        reader.onload = (e) => {
          const img = new Image();
          img.onload = () => {
            images.push({
              id: 'img_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
              name: file.name,
              originalSize: file.size,
              compressedSize: null,
              dataUrl: e.target.result,
              width: img.width,
              height: img.height
            });
            renderImages();
            updateStats();
          };
          img.src = e.target.result;
        };
        reader.readAsDataURL(file);
      });
    }

    function renderImages() {
      if (images.length === 0) {
        imagesGrid.innerHTML = '';
        actionBar.classList.add('hidden');
        return;
      }

      actionBar.classList.remove('hidden');
      
      // ì¹´ë“œ ìƒì„±
      imagesGrid.innerHTML = '';
      images.forEach(img => {
        const card = document.createElement('div');
        card.className = 'image-card';
        card.innerHTML = `
          <img src="${img.dataUrl}" class="image-preview" alt="${img.name}">
          <div class="image-info">
            <div class="image-name">${img.name}</div>
            <div class="image-stats">
              <span>${img.width} x ${img.height}</span>
              <span>${formatSize(img.originalSize)}</span>
            </div>
            ${img.compressedSize ? `
              <div class="size-badge">
                ì••ì¶• í›„: ${formatSize(img.compressedSize)} 
                (-${Math.round((1 - img.compressedSize / img.originalSize) * 100)}%)
              </div>
            ` : ''}
            <button class="remove-btn" data-id="${img.id}">ğŸ—‘ï¸ ì‚­ì œ</button>
          </div>
        `;
        
        // ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸
        card.querySelector('.remove-btn').addEventListener('click', () => {
          removeImage(img.id);
        });
        
        imagesGrid.appendChild(card);
      });
    }

    function updateStats() {
      $('imageCount').textContent = images.length;
      const totalOriginal = images.reduce((sum, img) => sum + img.originalSize, 0);
      const estimatedCompressed = totalOriginal * settings.quality;
      const saved = totalOriginal - estimatedCompressed;
      $('savedSize').textContent = formatSize(saved);
    }

    function removeImage(id) {
      images = images.filter(img => img.id !== id);
      renderImages();
      updateStats();
    }

    function clearAll() {
      if (confirm('ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        images = [];
        renderImages();
        updateStats();
      }
    }

    async function compressAll() {
      if (images.length === 0) return;

      loading.classList.add('show');
      $('compressBtn').disabled = true;

      for (let i = 0; i < images.length; i++) {
        await compressImage(images[i]);
      }

      loading.classList.remove('show');
      $('compressBtn').disabled = false;
      renderImages();
      updateStats();

      // ìë™ ë‹¤ìš´ë¡œë“œ
      downloadAll();
    }

    function compressImage(img) {
      return new Promise((resolve) => {
        const image = new Image();
        image.onload = () => {
          const canvas = document.createElement('canvas');
          let width = image.width;
          let height = image.height;

          if (width > settings.maxWidth) {
            height = (height * settings.maxWidth) / width;
            width = settings.maxWidth;
          }

          canvas.width = width;
          canvas.height = height;

          const ctx = canvas.getContext('2d');
          ctx.drawImage(image, 0, 0, width, height);

          canvas.toBlob((blob) => {
            img.compressedSize = blob.size;
            img.compressedBlob = blob;
            resolve();
          }, 'image/' + settings.format, settings.quality);
        };
        image.src = img.dataUrl;
      });
    }

    function downloadAll() {
      images.forEach(img => {
        if (img.compressedBlob) {
          const url = URL.createObjectURL(img.compressedBlob);
          const a = document.createElement('a');
          a.href = url;
          a.download = img.name.replace(/\.[^/.]+$/, '') + '_compressed.' + settings.format;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        }
      });
    }

    function formatSize(bytes) {
      if (bytes < 1024) return bytes + ' B';
      if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
      return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    init();
  </script>
</body>
</html>